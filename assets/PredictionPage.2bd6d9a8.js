import{u as g,f as x,r as l,g as O,o as h,i as j,c as M,a as e,t as _,b as v,e as S,q as L,j as f,v as p}from"./index.1107b5b2.js";import{U as r}from"./env.6b4efaae.js";import{T as d}from"./toastify.41cb22a4.js";import{L as k}from"./Loader.91909d1b.js";import"./_plugin-vue_export-helper.cdc0426e.js";const y=()=>{const i=document.createElement("audio");i.src="/src/assets/gol.mp3",i.play()},N={key:1,class:"row"},$={class:"col-md-9"},A={class:"card mt-3"},D={class:"card-body"},E={class:"d-flex justify-content-evenly"},P={class:"text-center"},G=["src"],I=e("strong",null,"vs",-1),V={class:"text-center"},B=["src"],R=e("i",{class:"fas fa-futbol"},null,-1),U={class:"card mt-3"},q={class:"card-body"},W=["onSubmit"],C={class:"d-flex justify-content-between"},F={class:"text-center mb-3"},H=e("label",{for:"home"},"Local",-1),J=e("strong",null,"vs",-1),Y={class:"text-center mb-3"},z=e("label",{for:"away"},"Visitante",-1),K=e("div",{class:"d-flex justify-content-end"},[e("button",{class:"btn btn-outline-primary"},"Pronosticar")],-1),Q=e("div",{class:"col-md-3"},"publicidad",-1),oe={__name:"PredictionPage",setup(i){const a=g(),u=x(),m=l(!0),n=l({}),s=l({home:0,away:0,winner:"DRAW"});O(async()=>{await w()});const w=async()=>{const o=await(await fetch(`${r}/api/match/${u.params.idMatch}`)).json();n.value=o,a.dispatch("setScore",o.score),m.value=!1},T=async()=>{s.value.home>s.value.away?s.value.winner="HOME_TEAM":s.value.away>s.value.home?s.value.winner="AWAY_TEAM":s.value.winner="DRAW";let c={date:Date.now(),id_match:n.value.id,date_match:n.value.utcDate,stage_match:n.value.stage,predict:s.value};const t=await(await fetch(`${r}/api/predictMatch`,{method:"POST",headers:{"Content-Type":"application/json",token:a.state.token},body:JSON.stringify(c)})).json();d({text:t.msg,position:"center"}).showToast()},b=()=>{const c=setInterval(async()=>{const t=await(await fetch(`${r}/api/updateMatch/${u.params.idMatch}`)).json();console.log(t.score),t.status==="FINISHED"&&(console.log("Fin"),clearInterval(c)),t.score.fullTime.home>a.state.score.fullTime.home&&(console.log("GOOOL",t.homeTeam.shortName),a.dispatch("setScore",t.score),y(),d({text:`GOOOL ${t.homeTeam.shortName}`,duration:-1,close:!0}).showToast()),t.score.fullTime.away>a.state.score.fullTime.away&&(console.log("GOOOL",t.awayTeam.shortName),a.dispatch("setScore",t.score),y(),d({text:`GOOOL ${t.awayTeam.shortName}`,duration:-1,close:!0}).showToast())},2e4)};return(c,o)=>m.value?(h(),j(k,{key:0})):(h(),M("div",N,[e("div",$,[e("div",A,[e("div",D,[e("div",E,[e("div",P,[e("img",{src:n.value.homeTeam.crest,alt:"home",height:"124"},null,8,G),e("h1",null,_(v(a).state.score.fullTime.home||0),1)]),I,e("div",V,[e("img",{src:n.value.awayTeam.crest,alt:"away",height:"124"},null,8,B),e("h1",null,_(v(a).state.score.fullTime.away||0),1)])]),e("div",{class:"d-flex justify-content-end"},[e("button",{class:"btn btn-outline-danger",onClick:b},[R,S("Live")])])])]),e("div",U,[e("div",q,[e("form",{onSubmit:L(T,["prevent"])},[e("div",C,[e("div",F,[H,f(e("input",{id:"home",class:"form-control text-center",type:"number",min:"0","onUpdate:modelValue":o[0]||(o[0]=t=>s.value.home=t),required:""},null,512),[[p,s.value.home]])]),J,e("div",Y,[z,f(e("input",{id:"away",class:"form-control text-center",type:"number",min:"0","onUpdate:modelValue":o[1]||(o[1]=t=>s.value.away=t),required:""},null,512),[[p,s.value.away]])])]),K],40,W)])])]),Q]))}};export{oe as default};
